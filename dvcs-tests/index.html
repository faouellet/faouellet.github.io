<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.1"><meta name="generator" content="Jekyll v4.1.1" /><meta property="og:title" content="Of source control and databases - Annex A - Testing strategies" /><meta name="author" content="Félix-Antoine Ouellet" /><meta property="og:locale" content="en_US" /><meta name="description" content="How to tell if it’s working" /><meta property="og:description" content="How to tell if it’s working" /><link rel="canonical" href="https://faouellet.github.io//dvcs-tests/" /><meta property="og:url" content="https://faouellet.github.io//dvcs-tests/" /><meta property="og:site_name" content="/* Insert Code Here */" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-02-07T00:00:00-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Of source control and databases - Annex A - Testing strategies" /> <script type="application/ld+json"> {"description":"How to tell if it’s working","url":"https://faouellet.github.io//dvcs-tests/","headline":"Of source control and databases - Annex A - Testing strategies","dateModified":"2021-02-07T00:00:00-05:00","@type":"BlogPosting","datePublished":"2021-02-07T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://faouellet.github.io//dvcs-tests/"},"author":{"@type":"Person","name":"Félix-Antoine Ouellet"},"@context":"https://schema.org"}</script><title>Of source control and databases - Annex A - Testing strategies | /* Insert Code Here */</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-71911238-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-71911238-1'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">/* Insert Code Here */</a></div><div class="site-subtitle font-italic"></div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tabs/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tabs/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/tabs/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tabs/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/faouellet" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://www.linkedin.com/in/felixantoineouellet/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['faouellet','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Of source control and databases - Annex A - Testing strategies</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Of source control and databases - Annex A - Testing strategies</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Feb 7, 2021, 12:00 AM -0500" > Feb 7 <i class="unloaded">2021-02-07T00:00:00-05:00</i> </span> by <span class="author"> Félix-Antoine Ouellet </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="893 words">4 min</span></div></div><div class="post-content"><hr /><p>All the code for the articles in this series can be found <a href="https://github.com/faouellet/DVCSUS">here</a>.</p><hr /><p>While programming something new is always fun, there comes a time when we have to put our invention to the test. Can the thing we created stand the test of reality?</p><p>So far, you, the reader, had to blindly assume that what I was showing you was indeed working. In this article, I will demonstrate that your faith in me wasn’t miguided. To do so, I will show you the two main testing strategies I put in place to assess DVCSUS.</p><h2 id="validating-the-repositorys-state">Validating The Repository’s State</h2><p>The most important thing to test is the state of a DVCSUS repository after a given (set of) operation(s) has been run. To make sure the repository is in the correct state, we need to validate two things:</p><ol><li>The <code class="language-plaintext highlighter-rouge">Staging</code> and <code class="language-plaintext highlighter-rouge">Repository</code> databases are where they’re supposed to be inside the <code class="language-plaintext highlighter-rouge">.dvcs</code> folder.<li>The contents of said databases are what we expected them to be after a given operation.</ol><p>To this end, for the tests that required it, I put in place databases which were the equivalent of a merge of the <code class="language-plaintext highlighter-rouge">Staging</code> and <code class="language-plaintext highlighter-rouge">Repository</code> databases with the appropriate expected contents. Then, when the time comes to test a given operation, I only need to run a query which <a href="https://www.sqlite.org/lang_attach.html">attach</a> the test repository’s databases together and select the differences between this merger’s contents and the expected database’s contents (this can be done using the SQL EXCEPT clause). If no differences is found, this means that the tested operation is working as intended.</p><p>In terms of code, this validation process looks roughly like this:</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre><span class="kt">void</span> <span class="n">ValidateRepositoryContents</span><span class="p">(</span><span class="k">const</span> <span class="n">fs</span><span class="o">::</span><span class="n">path</span> <span class="o">&amp;</span><span class="n">expectedDatabasePath</span><span class="p">)</span> <span class="k">noexcept</span>
<span class="p">{</span>
  <span class="n">sqlite3</span> <span class="o">*</span><span class="n">pDBHandle</span><span class="p">;</span>
  <span class="n">BOOST_REQUIRE</span><span class="p">(</span><span class="n">sqlite3_open</span><span class="p">(</span><span class="n">dvcs</span><span class="o">::</span><span class="n">REPO_DB_PATH</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="o">&amp;</span><span class="n">pDBHandle</span><span class="p">)</span> <span class="o">==</span> <span class="n">SQLITE_OK</span><span class="p">);</span>
  <span class="n">BOOST_REQUIRE</span><span class="p">(</span><span class="n">pDBHandle</span> <span class="o">!=</span> <span class="nb">nullptr</span><span class="p">);</span>

  <span class="k">try</span>
  <span class="p">{</span>
    <span class="k">const</span> <span class="k">auto</span> <span class="n">contentQuery</span> <span class="o">=</span> <span class="cm">/* Omitted for brevity */</span>
    <span class="kt">char</span> <span class="o">*</span><span class="n">pErrMsg</span> <span class="o">=</span> <span class="nb">nullptr</span><span class="p">;</span>
    <span class="k">auto</span> <span class="n">callback</span> <span class="o">=</span> <span class="p">[](</span><span class="kt">void</span> <span class="o">*</span><span class="n">count</span><span class="p">,</span> <span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">pArgv</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">iRes</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">iRes</span> <span class="o">&lt;</span> <span class="n">argc</span><span class="p">;</span> <span class="o">++</span><span class="n">iRes</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="n">fmt</span><span class="o">::</span><span class="n">print</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="p">,</span> <span class="s">"{}</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">pArgv</span><span class="p">[</span><span class="n">iRes</span><span class="p">]);</span>
      <span class="p">}</span>
      <span class="kt">int</span> <span class="o">*</span><span class="n">pCount</span> <span class="o">=</span> <span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="kt">int</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">count</span><span class="p">);</span>
      <span class="o">++</span><span class="p">(</span><span class="o">*</span><span class="n">pCount</span><span class="p">);</span>
      <span class="k">return</span> <span class="n">SQLITE_OK</span><span class="p">;</span>
    <span class="p">};</span>
    <span class="kt">int</span> <span class="n">nbResults</span><span class="p">{};</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">sqlite3_exec</span><span class="p">(</span><span class="n">pDBHandle</span><span class="p">,</span> <span class="n">contentQuery</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="n">callback</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nbResults</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pErrMsg</span><span class="p">)</span> <span class="o">!=</span> <span class="n">SQLITE_OK</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">fmt</span><span class="o">::</span><span class="n">print</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="p">,</span> <span class="s">"SQLite error: {}</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">pErrMsg</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">BOOST_CHECK</span><span class="p">(</span><span class="n">nbResults</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span>
    <span class="n">BOOST_REQUIRE</span><span class="p">(</span><span class="n">sqlite3_close</span><span class="p">(</span><span class="n">pDBHandle</span><span class="p">)</span> <span class="o">==</span> <span class="n">SQLITE_OK</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">catch</span> <span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">exception</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">fmt</span><span class="o">::</span><span class="n">print</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="p">,</span> <span class="s">"{}</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">());</span>
    <span class="n">BOOST_REQUIRE</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="validating-messages">Validating Messages</h2><p>Although of a somehat lesser importance (especially in the context of a prototype), the messages shown to the user must also be tested. Don’t forget that in a <em>Real World</em>™ context, a message shown at a wrong time (or not shown at all) can lead to a bad user experience.</p><p>Since all interactions of DVCSUS are done in the console, recording the messages shown to the user boils down to capturing a standard stream. To do this, I put in place the following <code class="language-plaintext highlighter-rouge">StreamInterceptor</code> class.</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">TStream</span><span class="p">&gt;</span> <span class="n">requires</span> <span class="n">std</span><span class="o">::</span><span class="n">derived_from</span><span class="o">&lt;</span><span class="n">TStream</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">ostream</span><span class="o">&gt;</span> 
<span class="k">class</span> <span class="nc">StreamInterceptor</span>
<span class="p">{</span>
<span class="nl">public:</span>
  <span class="k">explicit</span> <span class="n">StreamInterceptor</span><span class="p">(</span><span class="n">TStream</span> <span class="o">&amp;</span><span class="n">stream</span><span class="p">)</span> <span class="o">:</span> <span class="n">m_originalStream</span><span class="p">{</span><span class="n">stream</span><span class="p">}</span> 
  <span class="p">{</span> 
    <span class="n">m_pOldBuffer</span> <span class="o">=</span> <span class="n">m_originalStream</span><span class="p">.</span><span class="n">rdbuf</span><span class="p">(</span><span class="n">m_contentStream</span><span class="p">.</span><span class="n">rdbuf</span><span class="p">());</span> 
  <span class="p">}</span>
  <span class="o">~</span><span class="n">StreamInterceptor</span><span class="p">()</span> <span class="p">{</span> <span class="n">m_originalStream</span><span class="p">.</span><span class="n">rdbuf</span><span class="p">(</span><span class="n">m_pOldBuffer</span><span class="p">);</span> <span class="p">}</span>
  <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">GetStreamContent</span><span class="p">()</span> <span class="k">const</span>
  <span class="p">{</span>
    <span class="k">auto</span> <span class="n">str</span> <span class="o">=</span> <span class="n">m_contentStream</span><span class="p">.</span><span class="n">str</span><span class="p">();</span>
    <span class="n">m_contentStream</span><span class="p">.</span><span class="n">str</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">{});</span>
    <span class="k">return</span> <span class="n">str</span><span class="p">;</span>
  <span class="p">}</span>

<span class="nl">private:</span>
  <span class="n">TStream</span> <span class="o">&amp;</span><span class="n">m_originalStream</span><span class="p">;</span>
  <span class="k">mutable</span> <span class="n">std</span><span class="o">::</span><span class="n">stringstream</span> <span class="n">m_contentStream</span><span class="p">;</span>
  <span class="n">std</span><span class="o">::</span><span class="n">streambuf</span> <span class="o">*</span><span class="n">m_pOldBuffer</span><span class="p">;</span>
<span class="p">};</span>
</pre></table></code></div></div><p>The trick here, if it can be called as such, is that <code class="language-plaintext highlighter-rouge">StreamInterceptor</code> will swap <code class="language-plaintext highlighter-rouge">stream</code>’s buffer with its own <code class="language-plaintext highlighter-rouge">m_contentStream</code>’s buffer. Thus, any writes to <code class="language-plaintext highlighter-rouge">stream</code> will be redirected to <code class="language-plaintext highlighter-rouge">m_contentStream</code>. In other words, this will let us intercept anything that gets written to <code class="language-plaintext highlighter-rouge">std::cout</code> and <code class="language-plaintext highlighter-rouge">std::cerr</code>.</p><p>Moreover, do take note that <code class="language-plaintext highlighter-rouge">GetStreamContent</code> is intended to be used multiple times in a given test. In fact, its recommended usage is after each DVCSUS operation. Indeed, each time it’s called, it clears the <code class="language-plaintext highlighter-rouge">m_contentStream</code> to be ready to give a completely new string to the caller. This saves us the hassle of having to parse and make sense of a large multiline string at the very end of a given test.</p><p>Another tool which I’ve used in combination with <code class="language-plaintext highlighter-rouge">StreamInterceptor</code> is the below <code class="language-plaintext highlighter-rouge">StartsWith</code> function.</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">TStream</span><span class="p">&gt;</span>
<span class="kt">bool</span> <span class="nf">StartsWith</span><span class="p">(</span><span class="k">const</span> <span class="n">StreamInterceptor</span><span class="o">&lt;</span><span class="n">TStream</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">interceptor</span><span class="p">,</span> 
                <span class="n">std</span><span class="o">::</span><span class="n">string_view</span> <span class="n">expected</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">const</span> <span class="k">auto</span> <span class="n">content</span> <span class="o">=</span> <span class="n">interceptor</span><span class="p">.</span><span class="n">GetStreamContent</span><span class="p">();</span>
  <span class="k">return</span> <span class="n">content</span><span class="p">.</span><span class="n">starts_with</span><span class="p">(</span><span class="n">expected</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>The purpose of this function is quite simple: make sure that what <code class="language-plaintext highlighter-rouge">StreamInterceptor</code> has captured so far is as expected. The choice to validate on prefixes was made based on the fact that most of DVCSUS’ messages are formatted as to show information unique to a user or repository towards the end. This consequently allows the tests to be independent of both user and location on disk. I will note however that if I had to do more extensive validations on more complex messages, I’d probably would’ve went with an approach based on regexes instead of one based solely on strings such as <code class="language-plaintext highlighter-rouge">StartsWith</code>.</p><h2 id="sample-test">Sample Test</h2><p>All of the tools shown in this article can be combined to create clear and concise tests such as this:</p><div class="language-cpp highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="n">BOOST_FIXTURE_TEST_CASE</span><span class="p">(</span><span class="n">InitCommand</span><span class="p">,</span> <span class="n">TestFolderFixture</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">StreamInterceptor</span> <span class="n">coutInterceptor</span><span class="p">{</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="p">};</span>
  
  <span class="k">try</span>
  <span class="p">{</span>
    <span class="n">BOOST_CHECK</span><span class="p">(</span><span class="n">dvcs</span><span class="o">::</span><span class="n">Init</span><span class="p">());</span>

    <span class="cm">/* Validate the repository's file structure */</span>
    
    <span class="n">BOOST_CHECK</span><span class="p">(</span><span class="n">StartsWith</span><span class="p">(</span><span class="n">coutInterceptor</span><span class="p">,</span> <span class="s">"initialized empty repository:"</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">catch</span> <span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">exception</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">fmt</span><span class="o">::</span><span class="n">print</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="p">,</span> <span class="s">"{}</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">());</span>
    <span class="n">BOOST_REQUIRE</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">ValidateRepositoryContents</span><span class="p">(</span><span class="s">"InitTest.db"</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/of-source-control-and-databases/'>Of source control and databases</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/source-control/" class="post-tag no-text-decoration" >Source Control</a> <a href="/tags/database/" class="post-tag no-text-decoration" >Database</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Of source control and databases - Annex A - Testing strategies - /* Insert Code Here */&url=https://faouellet.github.io//dvcs-tests/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Of source control and databases - Annex A - Testing strategies - /* Insert Code Here */&u=https://faouellet.github.io//dvcs-tests/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Of source control and databases - Annex A - Testing strategies - /* Insert Code Here */&url=https://faouellet.github.io//dvcs-tests/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/database/">Database</a> <a class="post-tag" href="/tags/source-control/">Source Control</a> <a class="post-tag" href="/tags/c/">C++</a> <a class="post-tag" href="/tags/build-system/">Build System</a> <a class="post-tag" href="/tags/parallelism/">Parallelism</a> <a class="post-tag" href="/tags/compiler-development/">Compiler Development</a> <a class="post-tag" href="/tags/software-development/">Software Development</a> <a class="post-tag" href="/tags/c-amp/">C++AMP</a> <a class="post-tag" href="/tags/concurrency/">Concurrency</a> <a class="post-tag" href="/tags/gpgpu/">GPGPU</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/dvcs-intro/"><div class="card-body"> <span class="timeago small" > Feb 1 <i class="unloaded">2021-02-01T00:00:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Of source control and databases - Part 0 - Overview</h3><div class="text-muted small"><p> All the code for the articles in this series can be found here. Once again, I offer you an adaptation of some content I developed in my previous life as a teaching assistant. This time, I’ll b...</p></div></div></a></div><div class="card"> <a href="/dvcs-init/"><div class="card-body"> <span class="timeago small" > Feb 2 <i class="unloaded">2021-02-02T00:00:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Of source control and databases - Part 1 - Initializing a repository</h3><div class="text-muted small"><p> All the code for the articles in this series can be found here. The (obvious) first step in our endeavor is to allow users to set up a repository. To this end, we’ll offer them an init command...</p></div></div></a></div><div class="card"> <a href="/dvcs-add/"><div class="card-body"> <span class="timeago small" > Feb 3 <i class="unloaded">2021-02-03T00:00:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Of source control and databases - Part 2 - Adding changes</h3><div class="text-muted small"><p> All the code for the articles in this series can be found here. Now that the users can create a new repository through the init command, we can start filling it out. This will be the purpose o...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/dvcs-remote/" class="btn btn-outline-primary"><p>Of source control and databases - Part 5 - Remote support (ish)</p></a> <a href="/dvcs-error/" class="btn btn-outline-primary"><p>Of source control and databases - Annex B - Error management</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="font-italic text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> var options = { scriptUrl: '//insertcodehere.disqus.com/embed.js', disqusConfig: function() { this.page.url = 'https://faouellet.github.io//dvcs-tests/'; this.page.identifier = '/dvcs-tests/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://github.com/faouellet">Félix-Antoine Ouellet</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/database/">Database</a> <a class="post-tag" href="/tags/source-control/">Source Control</a> <a class="post-tag" href="/tags/c/">C++</a> <a class="post-tag" href="/tags/build-system/">Build System</a> <a class="post-tag" href="/tags/parallelism/">Parallelism</a> <a class="post-tag" href="/tags/compiler-development/">Compiler Development</a> <a class="post-tag" href="/tags/software-development/">Software Development</a> <a class="post-tag" href="/tags/c-amp/">C++AMP</a> <a class="post-tag" href="/tags/concurrency/">Concurrency</a> <a class="post-tag" href="/tags/gpgpu/">GPGPU</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://faouellet.github.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
